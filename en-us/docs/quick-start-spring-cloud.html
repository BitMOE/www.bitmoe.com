<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<meta name="keywords" content="quick-start-spring-cloud" />
	<meta name="description" content="quick-start-spring-cloud" />
	<!-- 网页标签标题 -->
	<title>quick-start-spring-cloud</title>
	<link rel="shortcut icon" href="/img/nacos.ico"/>
	<link rel="stylesheet" href="/build/documentation.css" />
</head>
<body>
	<div id="root"><div class="documentation-page" data-reactroot="" data-reactid="1" data-react-checksum="1453486313"><header class="header-container header-container-normal" data-reactid="2"><div class="header-body" data-reactid="3"><a href="/en-us/index.html" data-reactid="4"><img class="logo" src="/img/nacos_colorful.png" data-reactid="5"/></a><span class="language-switch language-switch-normal" data-reactid="6">中</span><div class="header-menu" data-reactid="7"><img class="header-menu-toggle" src="/img/menu_gray.png" data-reactid="8"/><ul data-reactid="9"><li class="menu-item menu-item-normal" data-reactid="10"><a href="/en-us/index.html" data-reactid="11">HOME</a></li><li class="menu-item menu-item-normal menu-item-normal-active" data-reactid="12"><a href="/en-us/docs/products-and-service.html" data-reactid="13">DOCS</a></li><li class="menu-item menu-item-normal" data-reactid="14"><a href="/en-us/blog" data-reactid="15">BLOG</a></li><li class="menu-item menu-item-normal" data-reactid="16"><a href="/en-us/community" data-reactid="17">COMMUNITY</a></li></ul></div></div></header><div class="bar" data-reactid="18"><div class="bar-body" data-reactid="19"><img src="/img/docs.png" class="front-img" data-reactid="20"/><div class="bar-title" data-reactid="21"><span data-reactid="22">Documentation</span><div class="bone bone-light" data-reactid="23"></div></div><img src="/img/docs.png" class="back-img" data-reactid="24"/></div></div><section class="content-section" data-reactid="25"><div class="content-body" data-reactid="26"><div class="sidemenu" data-reactid="27"><div class="sidemenu-toggle" data-reactid="28"><img src="https://img.alicdn.com/tfs/TB1E6apXHGYBuNjy0FoXXciBFXa-200-200.png" data-reactid="29"/></div><ul data-reactid="30"><li class="menu-item menu-item-level-1" data-reactid="31"><span data-reactid="32">Products / Services</span><ul data-reactid="33"><li style="height:72px;overflow:hidden;" class="menu-item menu-item-level-2" data-reactid="34"><span data-reactid="35"><!-- react-text: 36 -->Details of BitMOE Info. Products and Services<!-- /react-text --><img style="transform:rotate(0deg);" class="menu-toggle" src="/img/arrow_down.png" data-reactid="37"/></span><ul data-reactid="38"><li class="menu-item menu-item-level-3" data-reactid="39"><a href="/en-us/docs/products-and-service.html" target="_self" data-reactid="40">Product and Service Overview</a></li></ul></li><li style="height:180px;overflow:hidden;" class="menu-item menu-item-level-2" data-reactid="41"><span data-reactid="42"><!-- react-text: 43 -->Quick Start<!-- /react-text --><img style="transform:rotate(0deg);" class="menu-toggle" src="/img/arrow_down.png" data-reactid="44"/></span><ul data-reactid="45"><li class="menu-item menu-item-level-3" data-reactid="46"><a href="/en-us/docs/quick-start.html" target="_self" data-reactid="47">Nacos Quick Start</a></li><li class="menu-item menu-item-level-3" data-reactid="48"><a href="/en-us/docs/quick-start-spring.html" target="_self" data-reactid="49">Quick Start Spring</a></li><li class="menu-item menu-item-level-3" data-reactid="50"><a href="/en-us/docs/quick-start-spring-boot.html" target="_self" data-reactid="51">Quick Start Spring Boot</a></li><li class="menu-item menu-item-level-3" data-reactid="52"><a href="/en-us/docs/quick-start-spring-cloud.html" target="_self" data-reactid="53">Quick Start Spring Cloud</a></li></ul></li><li style="height:144px;overflow:hidden;" class="menu-item menu-item-level-2" data-reactid="54"><span data-reactid="55"><!-- react-text: 56 -->User Guide<!-- /react-text --><img style="transform:rotate(0deg);" class="menu-toggle" src="/img/arrow_down.png" data-reactid="57"/></span><ul data-reactid="58"><li class="menu-item menu-item-level-3" data-reactid="59"><a href="/en-us/docs/sdk.html" target="_self" data-reactid="60">Java SDK</a></li><li class="menu-item menu-item-level-3" data-reactid="61"><a href="/en-us/docs/other-language.html" target="_self" data-reactid="62">Other Language</a></li><li class="menu-item menu-item-level-3" data-reactid="63"><a href="/en-us/docs/open-API.html" target="_self" data-reactid="64">Open-API</a></li></ul></li><li style="height:36px;overflow:hidden;" class="menu-item menu-item-level-2" data-reactid="65"><span data-reactid="66"><!-- react-text: 67 -->Admin Guide<!-- /react-text --><img style="transform:rotate(-90deg);" class="menu-toggle" src="/img/arrow_down.png" data-reactid="68"/></span><ul data-reactid="69"><li class="menu-item menu-item-level-3" data-reactid="70"><a href="/en-us/docs/deployment.html" target="_self" data-reactid="71">Deployment Guide</a></li><li class="menu-item menu-item-level-3" data-reactid="72"><a href="/en-us/docs/cluster-mode-quick-start.html" target="_self" data-reactid="73">Cluster Mode Deployment</a></li><li class="menu-item menu-item-level-3" data-reactid="74"><a href="/en-us/docs/managementAPI.html" target="_self" data-reactid="75">Management OpenAPI</a></li><li class="menu-item menu-item-level-3" data-reactid="76"><a href="/en-us/docs/CLI-guide.html" target="_self" data-reactid="77">Nacos Operator CLI Guide</a></li><li class="menu-item menu-item-level-3" data-reactid="78"><a href="/en-us/docs/console-guide.html" target="_self" data-reactid="79">Admin Console Guide</a></li></ul></li><li style="height:36px;overflow:hidden;" class="menu-item menu-item-level-2" data-reactid="80"><span data-reactid="81"><!-- react-text: 82 -->Contributor Guide<!-- /react-text --><img style="transform:rotate(-90deg);" class="menu-toggle" src="/img/arrow_down.png" data-reactid="83"/></span><ul data-reactid="84"><li class="menu-item menu-item-level-3" data-reactid="85"><a href="/en-us/docs/contributing.html" target="_self" data-reactid="86">Contribute to Nacos</a></li><li class="menu-item menu-item-level-3" data-reactid="87"><a href="/zh-cn/docs/activity.html" target="_self" data-reactid="88">Nacos Activity</a></li><li class="menu-item menu-item-level-3" data-reactid="89"><a href="/en-us/docs/pull-request.html" target="_self" data-reactid="90">Pull Request Template</a></li><li class="menu-item menu-item-level-3" data-reactid="91"><a href="/en-us/docs/how-to-reporting-bugs.html" target="_self" data-reactid="92">How to reporting bugs</a></li><li class="menu-item menu-item-level-3" data-reactid="93"><a href="/en-us/docs/roadmap.html" target="_self" data-reactid="94">Nacos RoadMap</a></li><li class="menu-item menu-item-level-3" data-reactid="95"><a href="/en-us/docs/use-nacos-with-springcloud.html" target="_self" data-reactid="96">Nacos with SpringCloud</a></li><li class="menu-item menu-item-level-3" data-reactid="97"><a href="/en-us/docs/use-nacos-with-dubbo.html" target="_self" data-reactid="98">Nacos with Dubbo</a></li><li class="menu-item menu-item-level-3" data-reactid="99"><a href="/en-us/docs/use-nacos-with-kubernetes.html" target="_self" data-reactid="100">Nacos with K8s</a></li><li class="menu-item menu-item-level-3" data-reactid="101"><a href="/en-us/docs/use-nacos-with-istio.html" target="_self" data-reactid="102">Nacos with Istio</a></li></ul></li><li style="height:36px;overflow:hidden;" class="menu-item menu-item-level-2" data-reactid="103"><span data-reactid="104"><!-- react-text: 105 -->Community<!-- /react-text --><img style="transform:rotate(-90deg);" class="menu-toggle" src="/img/arrow_down.png" data-reactid="106"/></span><ul data-reactid="107"><li class="menu-item menu-item-level-3" data-reactid="108"><a href="/en-us/docs/community.html" target="_self" data-reactid="109">Community</a></li></ul></li></ul></li></ul></div><div class="doc-content markdown-body" data-reactid="110"><h1>前提条件</h1>
<p>请先参看 <a href="https://nacos.io/zh-cn/docs/quick-start.html">Nacos 快速入门</a>，下载 Nacos Server 并启动服务。</p>
<h1>配置管理</h1>
<p><span data-type="color" style="color:rgb(38, 38, 38)"><span data-type="background" style="background-color:rgb(255, 255, 255)">完整示例代码</span></span>：<a href="https://github.com/nacos-group/nacos-example/nacos-spring-cloud-config-example">nacos-spring-cloud-config-example</a></p>
<h2>依赖</h2>
<pre><code>&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
    &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-config&lt;/artifactId&gt;
    &lt;version&gt;${latest.version}&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>
<h2>示例</h2>
<p><span data-type="color" style="color:rgb(38, 38, 38)"><span data-type="background" style="background-color:rgb(255, 255, 255)">在 </span></span><code>bootstrap.properties</code><span data-type="color" style="color:rgb(38, 38, 38)"><span data-type="background" style="background-color:rgb(255, 255, 255)"> 中配置 Nacos Server 的地址：</span></span></p>
<pre><code>spring.cloud.nacos.config.server-addr=127.0.0.1:8848
</code></pre>
<p>在 <code>application.properties</code> 配置：</p>
<pre><code>spring.application.name=example
</code></pre>
<p>在 Nacos Spring Cloud 中，Nacos 配置管理的 <code>dataId</code> 的拼接格式如下</p>
<pre><code class="language-plain">${prefix}-${spring.profile.active}.${file-extension}
</code></pre>
<ul>
<li><code>prefix</code> 默认为 <code>spring.application.name</code> 的值，也可以通过配置项 <code>spring.cloud.nacos.config.prefix</code>来配置。</li>
<li><code>spring.profile.active</code> 即为当前环境对应的 profile，详情可以参考 <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/boot-features-profiles.html#boot-features-profiles">Spring Boot文档</a>
__注意，当 __<code>spring.profile.active</code><strong> 为空时，对应的连接符 </strong><strong><code>-</code></strong><strong> 也将不存在，dataId 的拼接格式变成 </strong><strong><code><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi>p</mi><mi>r</mi><mi>e</mi><mi>f</mi><mi>i</mi><mi>x</mi></mrow><mo>&lt;</mo><mi mathvariant="normal">/</mi><mi>c</mi><mi>o</mi><mi>d</mi><mi>e</mi><mo>&gt;</mo><mo>&lt;</mo><mi mathvariant="normal">/</mi><mi>s</mi><mi>t</mi><mi>r</mi><mi>o</mi><mi>n</mi><mi>g</mi><mo>&gt;</mo><mo>&lt;</mo><mi>s</mi><mi>t</mi><mi>r</mi><mi>o</mi><mi>n</mi><mi>g</mi><mo>&gt;</mo><mi mathvariant="normal">.</mi><mo>&lt;</mo><mi mathvariant="normal">/</mi><mi>s</mi><mi>t</mi><mi>r</mi><mi>o</mi><mi>n</mi><mi>g</mi><mo>&gt;</mo><mo>&lt;</mo><mi>s</mi><mi>t</mi><mi>r</mi><mi>o</mi><mi>n</mi><mi>g</mi><mo>&gt;</mo><mo>&lt;</mo><mi>c</mi><mi>o</mi><mi>d</mi><mi>e</mi><mo>&gt;</mo></mrow><annotation encoding="application/x-tex">{prefix}&lt;/code&gt;&lt;/strong&gt;&lt;strong&gt;.&lt;/strong&gt;&lt;strong&gt;&lt;code&gt;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit">p</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">e</span><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="mord mathit">i</span><span class="mord mathit">x</span></span><span class="mrel">&lt;</span><span class="mord mathrm">/</span><span class="mord mathit">c</span><span class="mord mathit">o</span><span class="mord mathit">d</span><span class="mord mathit">e</span><span class="mrel">&gt;</span><span class="mrel">&lt;</span><span class="mord mathrm">/</span><span class="mord mathit">s</span><span class="mord mathit">t</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">o</span><span class="mord mathit">n</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mrel">&gt;</span><span class="mrel">&lt;</span><span class="mord mathit">s</span><span class="mord mathit">t</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">o</span><span class="mord mathit">n</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mrel">&gt;</span><span class="mord mathrm">.</span><span class="mrel">&lt;</span><span class="mord mathrm">/</span><span class="mord mathit">s</span><span class="mord mathit">t</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">o</span><span class="mord mathit">n</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mrel">&gt;</span><span class="mrel">&lt;</span><span class="mord mathit">s</span><span class="mord mathit">t</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit">o</span><span class="mord mathit">n</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mrel">&gt;</span><span class="mrel">&lt;</span><span class="mord mathit">c</span><span class="mord mathit">o</span><span class="mord mathit">d</span><span class="mord mathit">e</span><span class="mrel">&gt;</span></span></span></span>{file-extension}</code></strong></li>
<li><code>file-exetension</code> 为配置内容的数据格式，可以通过配置项 <code>spring.cloud.nacos.config.file-extension</code> 来配置。目前只支持 <code>properties</code> 类型。</li>
</ul>
<p>通过 Spring Cloud 原生注解 <code>@RefreshScope</code> 实现配置自动更新：</p>
<pre><code>@RestController
@RequestMapping(&quot;/config&quot;)
@RefreshScope
public class ConfigController {

    @Value(&quot;${useLocalCache:false}&quot;)
    private boolean useLocalCache;

    @RequestMapping(&quot;/get&quot;)
    public boolean get() {
        return useLocalCache;
    }
}
</code></pre>
<h2>运行</h2>
<p>首先通过调用 <a href="https://nacos.io/zh-cn/docs/open-API.html">Nacos Open API</a> 向 Nacos Server 发布配置：dataId 为<code>example.properties</code>，内容为<code>useLocalCache=true</code></p>
<pre><code>curl -X POST &quot;http://127.0.0.1:8848/nacos/v1/cs/configs?dataId=example.properties&amp;group=DEFAULT_GROUP&amp;content=useLocalCache=true&quot;
</code></pre>
<p>运行 <code>NacosConfigApplication</code>，调用 <code>curl http://localhost:8080/config/get</code>，返回内容是 <code>true</code>。</p>
<p>再次调用 <a href="https://nacos.io/zh-cn/docs/open-API.html">Nacos Open API</a> 向 Nacos Server 发布配置：dataId 为<code>example.properties</code>，内容为<code>useLocalCache=false</code></p>
<pre><code>curl -X POST &quot;http://127.0.0.1:8848/nacos/v1/cs/configs?dataId=example.properties&amp;group=DEFAULT_GROUP&amp;content=useLocalCache=false&quot;
</code></pre>
<p>再次访问 <code>http://localhost:8080/config/get</code>，此时返回内容为<code>false</code>，说明程序中的<code>useLocalCache</code>值已经被动态更新了。</p>
<h1>服务发现</h1>
<p>完整示例代码：<a href="https://github.com/nacos-group/nacos-example/nacos-spring-cloud-discovery-example">nacos-spring-cloud-discovery-example</a></p>
<h2>依赖</h2>
<pre><code>&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;
    &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-discovery&lt;/artifactId&gt;
    &lt;version&gt;${latest.version}&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>
<h2>示例</h2>
<h4>服务提供者</h4>
<p>在 <code>application.properties</code> 中配置 Nacos Server 的地址：</p>
<pre><code>server.port=8070
spring.application.name=service-provider

spring.cloud.nacos.discovery.server-addr=127.0.0.1:8848
</code></pre>
<p>通过 Spring Cloud 原生注解 <code>@EnableDiscoveryClient</code> 开启服务注册发现功能：</p>
<pre><code>@SpringBootApplication
@EnableDiscoveryClient
public class NacosProviderApplication {

	public static void main(String[] args) {
		SpringApplication.run(NacosProviderApplication.class, args);
	}

	@RestController
	class EchoController {
		@RequestMapping(value = &quot;/echo/{string}&quot;, method = RequestMethod.GET)
		public String echo(@PathVariable String string) {
			return &quot;Hello Nacos Discovery &quot; + string;
		}
	}
}
</code></pre>
<h4>服务消费者</h4>
<p>在 <code>application.properties</code> 中配置 Nacos Server 的地址：</p>
<pre><code>server.port=8080
spring.application.name=service-consumer

spring.cloud.nacos.discovery.server-addr=127.0.0.1:8848
</code></pre>
<p>通过 Spring Cloud 原生注解 <code>@EnableDiscoveryClient</code>  开启服务注册发现功能，给 <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/boot-features-resttemplate.html">RestTemplate</a> 实例添加  <code>@LoadBalanced</code> 注解，开启 <code>@LoadBalanced</code> 与 <a href="https://cloud.spring.io/spring-cloud-netflix/multi/multi_spring-cloud-ribbon.html">Ribbon</a> 的集成：</p>
<pre><code>@SpringBootApplication
@EnableDiscoveryClient
public class NacosConsumerApplication {

    @LoadBalanced
    @Bean
    public RestTemplate restTemplate() {
        return new RestTemplate();
    }

    public static void main(String[] args) {
        SpringApplication.run(NacosConsumerApplication.class, args);
    }

    @RestController
    public class TestController {

        private final RestTemplate restTemplate;

        @Autowired
        public TestController(RestTemplate restTemplate) {this.restTemplate = restTemplate;}

        @RequestMapping(value = &quot;/echo/{str}&quot;, method = RequestMethod.GET)
        public String echo(@PathVariable String str) {
            return restTemplate.getForObject(&quot;http://service-provider/echo/&quot; + str, String.class);
        }
    }
}
</code></pre>
<h2>运行</h2>
<p>启动 <code>ProviderApplication</code> 和 <code>ConsumerApplication</code> ，调用 <code>http://localhost:8080/echo/2018</code>，返回内容为 <code>Hello Nacos Discovery 2018</code>。</p>
<h1>更多</h1>
<ul>
<li><a href="https://github.com/alibaba/nacos">Nacos</a></li>
<li><a href="https://github.com/nacos-group/nacos-spring-project">Nacos Spring</a></li>
<li><a href="https://github.com/nacos-group/nacos-spring-boot-project">Nacos Spring Boot</a></li>
<li><a href="https://github.com/spring-cloud-incubator/spring-cloud-alibaba">Spring Cloud</a> <a href="https://github.com/spring-cloud-incubator/spring-cloud-alibaba">Alibaba</a></li>
</ul>
</div></div></section><footer class="footer-container" data-reactid="111"><div class="footer-body" data-reactid="112"><img src="/img/nacos_gray.png" data-reactid="113"/><div class="cols-container" data-reactid="114"><div class="col col-12" data-reactid="115"><h3 data-reactid="116">Vision</h3><p data-reactid="117">By providing an easy-to-use service infrastructure such as dynamic service discovery, service configuration, service sharing and management and etc., Nacos help users better construct, deliver and manage their own service platform, reuse and composite business service faster and deliver value of business innovation more quickly so as to win market for users in the era of cloud native and in all cloud environments, such as private, mixed, or public clouds.</p></div><div class="col col-3" data-reactid="118"><dl data-reactid="119"><dt data-reactid="120">关注我们</dt><dd data-reactid="121"><a href="/zh-cn/docs/what-is-nacos.html" target="_self" data-reactid="122">新浪微博</a></dd><dd data-reactid="123"><a href="/zh-cn/docs/quick-start.html" target="_self" data-reactid="124">新浪微博</a></dd><dd data-reactid="125"><a href="https://github.com/BitMOE" target="_self" data-reactid="126">Github</a></dd></dl></div><div class="col col-3" data-reactid="127"><dl data-reactid="128"><dt data-reactid="129">加入我们</dt><dd data-reactid="130"><a href="https://szcert.ebs.org.cn/b7cf3361-9046-4778-864a-3bd10b6f59ca" target="_self" data-reactid="131">社会招聘</a></dd><dd data-reactid="132"><a href="http://www.miitbeian.gov.cn" target="_self" data-reactid="133">校园招聘</a></dd><dd data-reactid="134"><a href="https://www.beian.gov.cn/portal/registerSystemInfo?recordcode=44030502000499" target="_self" data-reactid="135">国际招聘</a></dd></dl></div><div class="col col-3" data-reactid="136"><dl data-reactid="137"><dt data-reactid="138">联系我们</dt><dd data-reactid="139"><a href="https://szcert.ebs.org.cn/b7cf3361-9046-4778-864a-3bd10b6f59ca" target="_self" data-reactid="140">客户服务</a></dd><dd data-reactid="141"><a href="http://www.miitbeian.gov.cn" target="_self" data-reactid="142">合作洽谈</a></dd><dd data-reactid="143"><a href="https://www.beian.gov.cn/portal/registerSystemInfo?recordcode=44030502000499" target="_self" data-reactid="144">服务采购</a></dd></dl></div><div class="col col-3" data-reactid="145"><dl data-reactid="146"><dt data-reactid="147">法律信息</dt><dd data-reactid="148"><a href="https://szcert.ebs.org.cn/b7cf3361-9046-4778-864a-3bd10b6f59ca" target="_self" data-reactid="149">服务协议</a></dd><dd data-reactid="150"><a href="http://www.miitbeian.gov.cn" target="_self" data-reactid="151">隐私政策</a></dd><dd data-reactid="152"><a href="https://www.beian.gov.cn/portal/registerSystemInfo?recordcode=44030502000499" target="_self" data-reactid="153">知识产权</a></dd></dl></div></div><div class="copyright" data-reactid="154"><span data-reactid="155">Copyright © 2015-2018 Shenzhen BitMOE Information Technology Co., Ltd. All rights reserved.</span></div></div></footer></div></div>
	<script src="https://f.alicdn.com/react/15.4.1/react-with-addons.min.js"></script>
	<script src="https://f.alicdn.com/react/15.4.1/react-dom.min.js"></script>
	<script>
		window.rootPath = '';
  </script>
	<script src="/build/documentation.js"></script>
</body>
</html>